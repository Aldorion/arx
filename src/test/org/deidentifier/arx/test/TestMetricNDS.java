/*
 * ARX: Powerful Data Anonymization
 * Copyright (C) 2012 - 2014 Florian Kohlmayer, Fabian Prasser
 * 
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 * 
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
 * GNU General Public License for more details.
 * 
 * You should have received a copy of the GNU General Public License
 * along with this program. If not, see <http://www.gnu.org/licenses/>.
 */

package org.deidentifier.arx.test;

import java.io.IOException;
import java.util.Arrays;
import java.util.Collection;

import org.deidentifier.arx.ARXConfiguration;
import org.deidentifier.arx.AttributeType.Hierarchy;
import org.deidentifier.arx.Data;
import org.deidentifier.arx.DataHandle;
import org.deidentifier.arx.criteria.HierarchicalDistanceTCloseness;
import org.deidentifier.arx.criteria.KAnonymity;
import org.deidentifier.arx.criteria.RecursiveCLDiversity;
import org.deidentifier.arx.metric.v2.Metric_V2;
import org.junit.runner.RunWith;
import org.junit.runners.Parameterized;
import org.junit.runners.Parameterized.Parameters;

/**
 * Tests for the NDS metric
 * 
 * @author Fabian Prasser
 * @author Florian Kohlmayer
 */
@RunWith(Parameterized.class)
public class TestMetricNDS extends TestAnonymizationAbstract {

    @Parameters
    public static Collection<Object[]> cases() throws IOException {
        return Arrays.asList(new Object[][] {

                 // Default NDS
                 { new ARXAnonymizationTestCase(ARXConfiguration.create(1.0d, Metric_V2.createNDSMetric()).addCriterion(new KAnonymity(5)).addCriterion(new HierarchicalDistanceTCloseness("occupation", 0.2, Hierarchy.create("../arx-data/data-junit/adult_hierarchy_occupation.csv", ';'))), "occupation", "../arx-data/data-junit/adult.csv", "[0.8635899476162058, 0.838822738166283, 0.8363072740534446, 0.8176580472184213, 0.7743518334327966, 0.7743518334327965, 0.7743518334327962, 0.7743518334327962]", new int[] {0, 3, 0, 0, 2, 1, 1, 0}, false)},
                 { new ARXAnonymizationTestCase(ARXConfiguration.create(1.0d, Metric_V2.createNDSMetric()).addCriterion(new KAnonymity(5)), "occupation", "../arx-data/data-junit/adult.csv", "[0.2972481930906439, 0.2967805500130937, 0.12976593064120417, 0.12976593064120417, 0.12976593064120417, 0.12976593064120392, 0.12976593064120384, 0.12976593064120354]", new int[] {0, 3, 0, 0, 1, 0, 0, 0}, false)},
                 { new ARXAnonymizationTestCase(ARXConfiguration.create(1.0d, Metric_V2.createNDSMetric()).addCriterion(new HierarchicalDistanceTCloseness("occupation", 0.2, Hierarchy.create("../arx-data/data-junit/adult_hierarchy_occupation.csv", ';'))), "occupation", "../arx-data/data-junit/adult.csv", "[0.8635899476162058, 0.838822738166283, 0.8363072740534446, 0.8176580472184213, 0.7743518334327966, 0.7743518334327965, 0.7743518334327962, 0.7743518334327962]", new int[] {0, 3, 0, 0, 2, 1, 1, 0}, false)},
                 { new ARXAnonymizationTestCase(ARXConfiguration.create(1.0d, Metric_V2.createNDSMetric()).addCriterion(new RecursiveCLDiversity("occupation", 4.0, 5)), "occupation", "../arx-data/data-junit/adult.csv", "[0.4141161537222806, 0.4048463298189776, 0.34526667108724, 0.33718191128177205, 0.179762615211193, 0.17976261521119288, 0.17976261521119288, 0.17976261521119274]", new int[] {0, 3, 0, 0, 1, 1, 1, 0}, false)},
                 { new ARXAnonymizationTestCase(ARXConfiguration.create(0.05d, Metric_V2.createNDSMetric()).addCriterion(new KAnonymity(5)).addCriterion(new HierarchicalDistanceTCloseness("occupation", 0.2, Hierarchy.create("../arx-data/data-junit/adult_hierarchy_occupation.csv", ';'))), "occupation", "../arx-data/data-junit/adult.csv", "[1.0, 1.0, 1.0, 1.0, 1.0, 0.3095956833101254, 0.04876997546581797, 0.0487699754658179]", new int[] {1, 4, 0, 0, 3, 1, 2, 1}, false)},
                 { new ARXAnonymizationTestCase(ARXConfiguration.create(0.05d, Metric_V2.createNDSMetric()).addCriterion(new RecursiveCLDiversity("occupation", 4.0, 5)), "occupation", "../arx-data/data-junit/adult.csv", "[1.0, 1.0, 0.3036444864398911, 0.22532800989136773, 0.041343412240567604, 0.041343412240567604, 0.04134341224056758, 0.04134341224056747]", new int[] {0, 3, 0, 0, 3, 1, 2, 0}, false)},
                 { new ARXAnonymizationTestCase(ARXConfiguration.create(0.05d, Metric_V2.createNDSMetric()).addCriterion(new KAnonymity(5)).addCriterion(new HierarchicalDistanceTCloseness("occupation", 0.2, Hierarchy.create("../arx-data/data-junit/adult_hierarchy_occupation.csv", ';'))), "occupation", "../arx-data/data-junit/adult.csv", "[1.0, 1.0, 1.0, 1.0, 1.0, 0.3095956833101254, 0.04876997546581797, 0.0487699754658179]", new int[] {1, 4, 0, 0, 3, 1, 2, 1}, false)},
                 { new ARXAnonymizationTestCase(ARXConfiguration.create(0.05d, Metric_V2.createNDSMetric()).addCriterion(new RecursiveCLDiversity("occupation", 4.0, 5)), "occupation", "../arx-data/data-junit/adult.csv", "[1.0, 1.0, 0.3036444864398911, 0.22532800989136773, 0.041343412240567604, 0.041343412240567604, 0.04134341224056758, 0.04134341224056747]", new int[] {0, 3, 0, 0, 3, 1, 2, 0}, false)},
                 { new ARXAnonymizationTestCase(ARXConfiguration.create(0.05d, Metric_V2.createNDSMetric()).addCriterion(new HierarchicalDistanceTCloseness("occupation", 0.2, Hierarchy.create("../arx-data/data-junit/adult_hierarchy_occupation.csv", ';'))), "occupation", "../arx-data/data-junit/adult.csv", "[1.0, 1.0, 1.0, 1.0, 1.0, 0.3095956833101254, 0.04876997546581797, 0.0487699754658179]", new int[] {1, 4, 0, 0, 3, 1, 2, 1}, false)},
                 { new ARXAnonymizationTestCase(ARXConfiguration.create(0.05d, Metric_V2.createNDSMetric()).addCriterion(new HierarchicalDistanceTCloseness("occupation", 0.2, Hierarchy.create("../arx-data/data-junit/adult_hierarchy_occupation.csv", ';'))), "occupation", "../arx-data/data-junit/adult.csv", "[1.0, 1.0, 1.0, 1.0, 1.0, 0.3095956833101254, 0.04876997546581797, 0.0487699754658179]", new int[] {1, 4, 0, 0, 3, 1, 2, 1}, false)},

                 // Default NDS with Suppression/Generalization: 0.0d
                 { new ARXAnonymizationTestCase(ARXConfiguration.create(1.0d, Metric_V2.createNDSMetric(0.0d)).addCriterion(new KAnonymity(5)).addCriterion(new HierarchicalDistanceTCloseness("occupation", 0.2, Hierarchy.create("../arx-data/data-junit/adult_hierarchy_occupation.csv", ';'))), "occupation", "../arx-data/data-junit/adult.csv", "[3.218903236332474E-14, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]", new int[] {0, 0, 0, 0, 0, 0, 0, 0}, false)},
                 { new ARXAnonymizationTestCase(ARXConfiguration.create(1.0d, Metric_V2.createNDSMetric(0.0d)).addCriterion(new KAnonymity(5)), "occupation", "../arx-data/data-junit/adult.csv", "[3.218903236332474E-14, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]", new int[] {0, 0, 0, 0, 0, 0, 0, 0}, false)},
                 { new ARXAnonymizationTestCase(ARXConfiguration.create(1.0d, Metric_V2.createNDSMetric(0.0d)).addCriterion(new HierarchicalDistanceTCloseness("occupation", 0.2, Hierarchy.create("../arx-data/data-junit/adult_hierarchy_occupation.csv", ';'))), "occupation", "../arx-data/data-junit/adult.csv", "[3.218903236332474E-14, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]", new int[] {0, 0, 0, 0, 0, 0, 0, 0}, false)},
                 { new ARXAnonymizationTestCase(ARXConfiguration.create(1.0d, Metric_V2.createNDSMetric(0.0d)).addCriterion(new RecursiveCLDiversity("occupation", 4.0, 5)), "occupation", "../arx-data/data-junit/adult.csv", "[3.218903236332474E-14, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]", new int[] {0, 0, 0, 0, 0, 0, 0, 0}, false)},
                 { new ARXAnonymizationTestCase(ARXConfiguration.create(0.05d, Metric_V2.createNDSMetric(0.0d)).addCriterion(new KAnonymity(5)).addCriterion(new HierarchicalDistanceTCloseness("occupation", 0.2, Hierarchy.create("../arx-data/data-junit/adult_hierarchy_occupation.csv", ';'))), "occupation", "../arx-data/data-junit/adult.csv", "[1.0, 1.0, 1.0, 1.0, 1.0, 0.2717541940189648, 0.0, 0.0]", new int[] {1, 4, 0, 0, 3, 1, 2, 1}, false)},
                 { new ARXAnonymizationTestCase(ARXConfiguration.create(0.05d, Metric_V2.createNDSMetric(0.0d)).addCriterion(new RecursiveCLDiversity("occupation", 4.0, 5)), "occupation", "../arx-data/data-junit/adult.csv", "[1.0, 1.0, 0.2717541940189662, 0.19191919191919043, 0.0, 0.0, 0.0, 0.0]", new int[] {0, 3, 0, 0, 3, 1, 2, 0}, false)},
                 { new ARXAnonymizationTestCase(ARXConfiguration.create(0.05d, Metric_V2.createNDSMetric(0.0d)).addCriterion(new KAnonymity(5)).addCriterion(new HierarchicalDistanceTCloseness("occupation", 0.2, Hierarchy.create("../arx-data/data-junit/adult_hierarchy_occupation.csv", ';'))), "occupation", "../arx-data/data-junit/adult.csv", "[1.0, 1.0, 1.0, 1.0, 1.0, 0.2717541940189648, 0.0, 0.0]", new int[] {1, 4, 0, 0, 3, 1, 2, 1}, false)},
                 { new ARXAnonymizationTestCase(ARXConfiguration.create(0.05d, Metric_V2.createNDSMetric(0.0d)).addCriterion(new RecursiveCLDiversity("occupation", 4.0, 5)), "occupation", "../arx-data/data-junit/adult.csv", "[1.0, 1.0, 0.2717541940189662, 0.19191919191919043, 0.0, 0.0, 0.0, 0.0]", new int[] {0, 3, 0, 0, 3, 1, 2, 0}, false)},
                 { new ARXAnonymizationTestCase(ARXConfiguration.create(0.05d, Metric_V2.createNDSMetric(0.0d)).addCriterion(new HierarchicalDistanceTCloseness("occupation", 0.2, Hierarchy.create("../arx-data/data-junit/adult_hierarchy_occupation.csv", ';'))), "occupation", "../arx-data/data-junit/adult.csv", "[1.0, 1.0, 1.0, 1.0, 1.0, 0.2717541940189648, 0.0, 0.0]", new int[] {1, 4, 0, 0, 3, 1, 2, 1}, false)},
                 { new ARXAnonymizationTestCase(ARXConfiguration.create(0.05d, Metric_V2.createNDSMetric(0.0d)).addCriterion(new HierarchicalDistanceTCloseness("occupation", 0.2, Hierarchy.create("../arx-data/data-junit/adult_hierarchy_occupation.csv", ';'))), "occupation", "../arx-data/data-junit/adult.csv", "[1.0, 1.0, 1.0, 1.0, 1.0, 0.2717541940189648, 0.0, 0.0]", new int[] {1, 4, 0, 0, 3, 1, 2, 1}, false)},

                 // Default NDS with Suppression/Generalization: 0.33d
                 { new ARXAnonymizationTestCase(ARXConfiguration.create(1.0d, Metric_V2.createNDSMetric(0.33d)).addCriterion(new KAnonymity(5)).addCriterion(new HierarchicalDistanceTCloseness("occupation", 0.2, Hierarchy.create("../arx-data/data-junit/adult_hierarchy_occupation.csv", ';'))), "occupation", "../arx-data/data-junit/adult.csv", "[0.6348915854385675, 0.6195185995628717, 0.6195185995628717, 0.619518599562482, 0.6195185995624427, 0.619518599562315, 0.6195185995622476, 0.6195185995621653]", new int[] {0, 1, 0, 0, 0, 0, 0, 0}, false)},
                 { new ARXAnonymizationTestCase(ARXConfiguration.create(1.0d, Metric_V2.createNDSMetric(0.33d)).addCriterion(new KAnonymity(5)), "occupation", "../arx-data/data-junit/adult.csv", "[0.23003448047208847, 0.19761487965005387, 0.19761487965005387, 0.19761487964990987, 0.19761487964990135, 0.19761487964985977, 0.19761487964985558, 0.19761487964981095]", new int[] {0, 1, 0, 0, 0, 0, 0, 0}, false)},
                 { new ARXAnonymizationTestCase(ARXConfiguration.create(1.0d, Metric_V2.createNDSMetric(0.33d)).addCriterion(new HierarchicalDistanceTCloseness("occupation", 0.2, Hierarchy.create("../arx-data/data-junit/adult_hierarchy_occupation.csv", ';'))), "occupation", "../arx-data/data-junit/adult.csv", "[0.6348915854385675, 0.6195185995628717, 0.6195185995628717, 0.619518599562482, 0.6195185995624427, 0.619518599562315, 0.6195185995622476, 0.6195185995621653]", new int[] {0, 1, 0, 0, 0, 0, 0, 0}, false)},
                 { new ARXAnonymizationTestCase(ARXConfiguration.create(1.0d, Metric_V2.createNDSMetric(0.33d)).addCriterion(new RecursiveCLDiversity("occupation", 4.0, 5)), "occupation", "../arx-data/data-junit/adult.csv", "[0.34141635170080503, 0.27555798687114336, 0.27555798687114336, 0.2755579868709243, 0.2755579868708692, 0.27555798687086197, 0.2755579868708536, 0.2755579868707911]", new int[] {0, 2, 0, 0, 0, 0, 0, 0}, false)},
                 { new ARXAnonymizationTestCase(ARXConfiguration.create(0.05d, Metric_V2.createNDSMetric(0.33d)).addCriterion(new KAnonymity(5)).addCriterion(new HierarchicalDistanceTCloseness("occupation", 0.2, Hierarchy.create("../arx-data/data-junit/adult_hierarchy_occupation.csv", ';'))), "occupation", "../arx-data/data-junit/adult.csv", "[1.0, 1.0, 1.0, 1.0, 1.0, 0.2967295769511308, 0.03218818380744002, 0.03218818380743974]", new int[] {1, 4, 0, 0, 3, 1, 2, 1}, false)},
                 { new ARXAnonymizationTestCase(ARXConfiguration.create(0.05d, Metric_V2.createNDSMetric(0.33d)).addCriterion(new RecursiveCLDiversity("occupation", 4.0, 5)), "occupation", "../arx-data/data-junit/adult.csv", "[1.0, 1.0, 0.2928017870167759, 0.21396901178082933, 0.02728665207877632, 0.027286652078773187, 0.02728665207877029, 0.02728665207877029]", new int[] {0, 3, 0, 0, 3, 1, 2, 0}, false)},
                 { new ARXAnonymizationTestCase(ARXConfiguration.create(0.05d, Metric_V2.createNDSMetric(0.33d)).addCriterion(new KAnonymity(5)).addCriterion(new HierarchicalDistanceTCloseness("occupation", 0.2, Hierarchy.create("../arx-data/data-junit/adult_hierarchy_occupation.csv", ';'))), "occupation", "../arx-data/data-junit/adult.csv", "[1.0, 1.0, 1.0, 1.0, 1.0, 0.2967295769511308, 0.03218818380744002, 0.03218818380743974]", new int[] {1, 4, 0, 0, 3, 1, 2, 1}, false)},
                 { new ARXAnonymizationTestCase(ARXConfiguration.create(0.05d, Metric_V2.createNDSMetric(0.33d)).addCriterion(new RecursiveCLDiversity("occupation", 4.0, 5)), "occupation", "../arx-data/data-junit/adult.csv", "[1.0, 1.0, 0.2928017870167759, 0.21396901178082933, 0.02728665207877632, 0.027286652078773187, 0.02728665207877029, 0.02728665207877029]", new int[] {0, 3, 0, 0, 3, 1, 2, 0}, false)},
                 { new ARXAnonymizationTestCase(ARXConfiguration.create(0.05d, Metric_V2.createNDSMetric(0.33d)).addCriterion(new HierarchicalDistanceTCloseness("occupation", 0.2, Hierarchy.create("../arx-data/data-junit/adult_hierarchy_occupation.csv", ';'))), "occupation", "../arx-data/data-junit/adult.csv", "[1.0, 1.0, 1.0, 1.0, 1.0, 0.2967295769511308, 0.03218818380744002, 0.03218818380743974]", new int[] {1, 4, 0, 0, 3, 1, 2, 1}, false)},
                 { new ARXAnonymizationTestCase(ARXConfiguration.create(0.05d, Metric_V2.createNDSMetric(0.33d)).addCriterion(new HierarchicalDistanceTCloseness("occupation", 0.2, Hierarchy.create("../arx-data/data-junit/adult_hierarchy_occupation.csv", ';'))), "occupation", "../arx-data/data-junit/adult.csv", "[1.0, 1.0, 1.0, 1.0, 1.0, 0.2967295769511308, 0.03218818380744002, 0.03218818380743974]", new int[] {1, 4, 0, 0, 3, 1, 2, 1}, false)},

                 // Default NDS with Suppression/Generalization: 0.66d
                 { new ARXAnonymizationTestCase(ARXConfiguration.create(1.0d, Metric_V2.createNDSMetric(0.66d)).addCriterion(new KAnonymity(5)).addCriterion(new HierarchicalDistanceTCloseness("occupation", 0.2, Hierarchy.create("../arx-data/data-junit/adult_hierarchy_occupation.csv", ';'))), "occupation", "../arx-data/data-junit/adult.csv", "[0.6778091018928715, 0.6746031746031745, 0.6657963446475196, 0.6502732240437158, 0.6296296296296297, 0.5151515151515151, 0.27963553771658356, 0.0]", new int[] {0, 4, 1, 1, 3, 2, 2, 1}, false)},
                 { new ARXAnonymizationTestCase(ARXConfiguration.create(1.0d, Metric_V2.createNDSMetric(0.66d)).addCriterion(new KAnonymity(5)), "occupation", "../arx-data/data-junit/adult.csv", "[0.23818864470656162, 0.2373814339076919, 0.18606580446258766, 0.18390975936210793, 0.06435249651880003, 0.06435249651880003, 0.06435249651879868, 0.06435249651879853]", new int[] {0, 3, 0, 0, 1, 1, 1, 0}, false)},
                 { new ARXAnonymizationTestCase(ARXConfiguration.create(1.0d, Metric_V2.createNDSMetric(0.66d)).addCriterion(new HierarchicalDistanceTCloseness("occupation", 0.2, Hierarchy.create("../arx-data/data-junit/adult_hierarchy_occupation.csv", ';'))), "occupation", "../arx-data/data-junit/adult.csv", "[0.6778091018928715, 0.6746031746031745, 0.6657963446475196, 0.6502732240437158, 0.6296296296296297, 0.5151515151515151, 0.27963553771658356, 0.0]", new int[] {0, 4, 1, 1, 3, 2, 2, 1}, false)},
                 { new ARXAnonymizationTestCase(ARXConfiguration.create(1.0d, Metric_V2.createNDSMetric(0.66d)).addCriterion(new RecursiveCLDiversity("occupation", 4.0, 5)), "occupation", "../arx-data/data-junit/adult.csv", "[0.3321564462648511, 0.3316048036370792, 0.2899546106378039, 0.2864628469014003, 0.179762615211193, 0.179762615211193, 0.17976261521119294, 0.17976261521119294]", new int[] {0, 3, 0, 0, 1, 1, 1, 0}, false)},
                 { new ARXAnonymizationTestCase(ARXConfiguration.create(0.05d, Metric_V2.createNDSMetric(0.66d)).addCriterion(new KAnonymity(5)).addCriterion(new HierarchicalDistanceTCloseness("occupation", 0.2, Hierarchy.create("../arx-data/data-junit/adult_hierarchy_occupation.csv", ';'))), "occupation", "../arx-data/data-junit/adult.csv", "[0.6778091018928715, 0.6746031746031745, 0.6657963446475196, 0.6502732240437158, 0.6296296296296297, 0.5151515151515151, 0.27963553771658356, 0.0]", new int[] {0, 4, 1, 1, 3, 2, 2, 1}, false)},
                 { new ARXAnonymizationTestCase(ARXConfiguration.create(0.05d, Metric_V2.createNDSMetric(0.66d)).addCriterion(new RecursiveCLDiversity("occupation", 4.0, 5)), "occupation", "../arx-data/data-junit/adult.csv", "[0.5360166213557892, 0.5360166213557892, 0.30786222751571873, 0.2768495727942913, 0.22083119098579876, 0.21953945388026364, 0.1675207604269205, 0.043034281546316444]", new int[] {1, 3, 0, 1, 2, 1, 1, 1}, false)},
                 { new ARXAnonymizationTestCase(ARXConfiguration.create(0.05d, Metric_V2.createNDSMetric(0.66d)).addCriterion(new KAnonymity(5)).addCriterion(new HierarchicalDistanceTCloseness("occupation", 0.2, Hierarchy.create("../arx-data/data-junit/adult_hierarchy_occupation.csv", ';'))), "occupation", "../arx-data/data-junit/adult.csv", "[0.6778091018928715, 0.6746031746031745, 0.6657963446475196, 0.6502732240437158, 0.6296296296296297, 0.5151515151515151, 0.27963553771658356, 0.0]", new int[] {0, 4, 1, 1, 3, 2, 2, 1}, false)},
                 { new ARXAnonymizationTestCase(ARXConfiguration.create(0.05d, Metric_V2.createNDSMetric(0.66d)).addCriterion(new RecursiveCLDiversity("occupation", 4.0, 5)), "occupation", "../arx-data/data-junit/adult.csv", "[0.5360166213557892, 0.5360166213557892, 0.30786222751571873, 0.2768495727942913, 0.22083119098579876, 0.21953945388026364, 0.1675207604269205, 0.043034281546316444]", new int[] {1, 3, 0, 1, 2, 1, 1, 1}, false)},
                 { new ARXAnonymizationTestCase(ARXConfiguration.create(0.05d, Metric_V2.createNDSMetric(0.66d)).addCriterion(new HierarchicalDistanceTCloseness("occupation", 0.2, Hierarchy.create("../arx-data/data-junit/adult_hierarchy_occupation.csv", ';'))), "occupation", "../arx-data/data-junit/adult.csv", "[0.6778091018928715, 0.6746031746031745, 0.6657963446475196, 0.6502732240437158, 0.6296296296296297, 0.5151515151515151, 0.27963553771658356, 0.0]", new int[] {0, 4, 1, 1, 3, 2, 2, 1}, false)},
                 { new ARXAnonymizationTestCase(ARXConfiguration.create(0.05d, Metric_V2.createNDSMetric(0.66d)).addCriterion(new HierarchicalDistanceTCloseness("occupation", 0.2, Hierarchy.create("../arx-data/data-junit/adult_hierarchy_occupation.csv", ';'))), "occupation", "../arx-data/data-junit/adult.csv", "[0.6778091018928715, 0.6746031746031745, 0.6657963446475196, 0.6502732240437158, 0.6296296296296297, 0.5151515151515151, 0.27963553771658356, 0.0]", new int[] {0, 4, 1, 1, 3, 2, 2, 1}, false)},

                 // Default NDS with Suppression/Generalization: 1.0d
                 { new ARXAnonymizationTestCase(ARXConfiguration.create(1.0d, Metric_V2.createNDSMetric(1.0d)).addCriterion(new KAnonymity(5)).addCriterion(new HierarchicalDistanceTCloseness("occupation", 0.2, Hierarchy.create("../arx-data/data-junit/adult_hierarchy_occupation.csv", ';'))), "occupation", "../arx-data/data-junit/adult.csv", "[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]", new int[] {1, 4, 0, 2, 3, 2, 2, 1}, false)},
                 { new ARXAnonymizationTestCase(ARXConfiguration.create(1.0d, Metric_V2.createNDSMetric(1.0d)).addCriterion(new KAnonymity(5)), "occupation", "../arx-data/data-junit/adult.csv", "[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]", new int[] {1, 4, 0, 2, 3, 2, 2, 0}, false)},
                 { new ARXAnonymizationTestCase(ARXConfiguration.create(1.0d, Metric_V2.createNDSMetric(1.0d)).addCriterion(new HierarchicalDistanceTCloseness("occupation", 0.2, Hierarchy.create("../arx-data/data-junit/adult_hierarchy_occupation.csv", ';'))), "occupation", "../arx-data/data-junit/adult.csv", "[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]", new int[] {1, 4, 0, 2, 3, 2, 2, 1}, false)},
                 { new ARXAnonymizationTestCase(ARXConfiguration.create(1.0d, Metric_V2.createNDSMetric(1.0d)).addCriterion(new RecursiveCLDiversity("occupation", 4.0, 5)), "occupation", "../arx-data/data-junit/adult.csv", "[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]", new int[] {1, 4, 0, 2, 3, 2, 2, 0}, false)},
                 { new ARXAnonymizationTestCase(ARXConfiguration.create(0.05d, Metric_V2.createNDSMetric(1.0d)).addCriterion(new KAnonymity(5)).addCriterion(new HierarchicalDistanceTCloseness("occupation", 0.2, Hierarchy.create("../arx-data/data-junit/adult_hierarchy_occupation.csv", ';'))), "occupation", "../arx-data/data-junit/adult.csv", "[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]", new int[] {1, 4, 0, 2, 3, 2, 2, 1}, false)},
                 { new ARXAnonymizationTestCase(ARXConfiguration.create(0.05d, Metric_V2.createNDSMetric(1.0d)).addCriterion(new RecursiveCLDiversity("occupation", 4.0, 5)), "occupation", "../arx-data/data-junit/adult.csv", "[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]", new int[] {1, 4, 0, 2, 3, 2, 2, 0}, false)},
                 { new ARXAnonymizationTestCase(ARXConfiguration.create(0.05d, Metric_V2.createNDSMetric(1.0d)).addCriterion(new KAnonymity(5)).addCriterion(new HierarchicalDistanceTCloseness("occupation", 0.2, Hierarchy.create("../arx-data/data-junit/adult_hierarchy_occupation.csv", ';'))), "occupation", "../arx-data/data-junit/adult.csv", "[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]", new int[] {1, 4, 0, 2, 3, 2, 2, 1}, false)},
                 { new ARXAnonymizationTestCase(ARXConfiguration.create(0.05d, Metric_V2.createNDSMetric(1.0d)).addCriterion(new RecursiveCLDiversity("occupation", 4.0, 5)), "occupation", "../arx-data/data-junit/adult.csv", "[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]", new int[] {1, 4, 0, 2, 3, 2, 2, 0}, false)},
                 { new ARXAnonymizationTestCase(ARXConfiguration.create(0.05d, Metric_V2.createNDSMetric(1.0d)).addCriterion(new HierarchicalDistanceTCloseness("occupation", 0.2, Hierarchy.create("../arx-data/data-junit/adult_hierarchy_occupation.csv", ';'))), "occupation", "../arx-data/data-junit/adult.csv", "[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]", new int[] {1, 4, 0, 2, 3, 2, 2, 1}, false)},
                 { new ARXAnonymizationTestCase(ARXConfiguration.create(0.05d, Metric_V2.createNDSMetric(1.0d)).addCriterion(new HierarchicalDistanceTCloseness("occupation", 0.2, Hierarchy.create("../arx-data/data-junit/adult_hierarchy_occupation.csv", ';'))), "occupation", "../arx-data/data-junit/adult.csv", "[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]", new int[] {1, 4, 0, 2, 3, 2, 2, 1}, false)},

                 // Weighted Default NDS
                 { weight(new ARXAnonymizationTestCase(ARXConfiguration.create(1.0d, Metric_V2.createNDSMetric()).addCriterion(new KAnonymity(5)).addCriterion(new HierarchicalDistanceTCloseness("occupation", 0.2, Hierarchy.create("../arx-data/data-junit/adult_hierarchy_occupation.csv", ';'))), "occupation", "../arx-data/data-junit/adult.csv", "[0.10810810810810811, 0.09333921150113711, 0.08966661111081241, 0.08217248479830537, 0.08108108108108109, 0.07259716450088441, 0.05405405405405406, 0.02702702702702703]", new int[] {1, 4, 1, 2, 2, 1, 0, 0}, false))},
                 { weight(new ARXAnonymizationTestCase(ARXConfiguration.create(1.0d, Metric_V2.createNDSMetric()).addCriterion(new KAnonymity(5)), "occupation", "../arx-data/data-junit/adult.csv", "[0.036129226501217755, 0.02810050950094714, 0.02702702702702703, 0.024086151000811795, 0.02007179250067653, 0.016861862495441145, 0.01605743400054114, 0.012043075500405868]", new int[] {1, 3, 0, 0, 0, 0, 0, 0}, false))},
                 { weight(new ARXAnonymizationTestCase(ARXConfiguration.create(1.0d, Metric_V2.createNDSMetric()).addCriterion(new HierarchicalDistanceTCloseness("occupation", 0.2, Hierarchy.create("../arx-data/data-junit/adult_hierarchy_occupation.csv", ';'))), "occupation", "../arx-data/data-junit/adult.csv", "[0.10810810810810811, 0.09333921150113711, 0.08966661111081241, 0.08217248479830537, 0.08108108108108109, 0.07259716450088441, 0.05405405405405406, 0.02702702702702703]", new int[] {1, 4, 1, 2, 2, 1, 0, 0}, false))},
                 { weight(new ARXAnonymizationTestCase(ARXConfiguration.create(1.0d, Metric_V2.createNDSMetric()).addCriterion(new RecursiveCLDiversity("occupation", 4.0, 5)), "occupation", "../arx-data/data-junit/adult.csv", "[0.05405405405405406, 0.04706954816364007, 0.044863144425507664, 0.03489355677539485, 0.02990876295033841, 0.02702702702702703, 0.019939175300225605, 0.014954381475169228]", new int[] {1, 4, 0, 0, 1, 0, 0, 0}, false))},
                 { weight(new ARXAnonymizationTestCase(ARXConfiguration.create(0.05d, Metric_V2.createNDSMetric()).addCriterion(new KAnonymity(5)).addCriterion(new HierarchicalDistanceTCloseness("occupation", 0.2, Hierarchy.create("../arx-data/data-junit/adult_hierarchy_occupation.csv", ';'))), "occupation", "../arx-data/data-junit/adult.csv", "[0.24324324324324326, 0.1891891891891892, 0.08108108108108109, 0.05407585823340747, 0.05405405405405406, 0.05016394950749438, 0.050083468190689207, 0.02702702702702703]", new int[] {1, 4, 1, 1, 2, 1, 2, 1}, false))},
                 { weight(new ARXAnonymizationTestCase(ARXConfiguration.create(0.05d, Metric_V2.createNDSMetric()).addCriterion(new RecursiveCLDiversity("occupation", 4.0, 5)), "occupation", "../arx-data/data-junit/adult.csv", "[0.06030408765638526, 0.05405405405405406, 0.05342800528796152, 0.0503174748251335, 0.04974220291506943, 0.02702702702702703, 0.011250060484196153, 0.0037500201613987084]", new int[] {1, 4, 0, 1, 2, 1, 1, 0}, false))},
                 { weight(new ARXAnonymizationTestCase(ARXConfiguration.create(0.05d, Metric_V2.createNDSMetric()).addCriterion(new KAnonymity(5)).addCriterion(new HierarchicalDistanceTCloseness("occupation", 0.2, Hierarchy.create("../arx-data/data-junit/adult_hierarchy_occupation.csv", ';'))), "occupation", "../arx-data/data-junit/adult.csv", "[0.24324324324324326, 0.1891891891891892, 0.08108108108108109, 0.05407585823340747, 0.05405405405405406, 0.05016394950749438, 0.050083468190689207, 0.02702702702702703]", new int[] {1, 4, 1, 1, 2, 1, 2, 1}, false))},
                 { weight(new ARXAnonymizationTestCase(ARXConfiguration.create(0.05d, Metric_V2.createNDSMetric()).addCriterion(new RecursiveCLDiversity("occupation", 4.0, 5)), "occupation", "../arx-data/data-junit/adult.csv", "[0.06030408765638526, 0.05405405405405406, 0.05342800528796152, 0.0503174748251335, 0.04974220291506943, 0.02702702702702703, 0.011250060484196153, 0.0037500201613987084]", new int[] {1, 4, 0, 1, 2, 1, 1, 0}, false))},
                 { weight(new ARXAnonymizationTestCase(ARXConfiguration.create(0.05d, Metric_V2.createNDSMetric()).addCriterion(new HierarchicalDistanceTCloseness("occupation", 0.2, Hierarchy.create("../arx-data/data-junit/adult_hierarchy_occupation.csv", ';'))), "occupation", "../arx-data/data-junit/adult.csv", "[0.24324324324324326, 0.1891891891891892, 0.08108108108108109, 0.05407585823340747, 0.05405405405405406, 0.05016394950749438, 0.050083468190689207, 0.02702702702702703]", new int[] {1, 4, 1, 1, 2, 1, 2, 1}, false))},
                 { weight(new ARXAnonymizationTestCase(ARXConfiguration.create(0.05d, Metric_V2.createNDSMetric()).addCriterion(new HierarchicalDistanceTCloseness("occupation", 0.2, Hierarchy.create("../arx-data/data-junit/adult_hierarchy_occupation.csv", ';'))), "occupation", "../arx-data/data-junit/adult.csv", "[0.24324324324324326, 0.1891891891891892, 0.08108108108108109, 0.05407585823340747, 0.05405405405405406, 0.05016394950749438, 0.050083468190689207, 0.02702702702702703]", new int[] {1, 4, 1, 1, 2, 1, 2, 1}, false))},

                 // Weighted NDS with Suppression/Generalization: 0.0d
                 { weight(new ARXAnonymizationTestCase(ARXConfiguration.create(1.0d, Metric_V2.createNDSMetric(0.0d)).addCriterion(new KAnonymity(5)).addCriterion(new HierarchicalDistanceTCloseness("occupation", 0.2, Hierarchy.create("../arx-data/data-junit/adult_hierarchy_occupation.csv", ';'))), "occupation", "../arx-data/data-junit/adult.csv", "[3.479895390629702E-15, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]", new int[] {0, 0, 0, 0, 0, 0, 0, 0}, false))},
                 { weight(new ARXAnonymizationTestCase(ARXConfiguration.create(1.0d, Metric_V2.createNDSMetric(0.0d)).addCriterion(new KAnonymity(5)), "occupation", "../arx-data/data-junit/adult.csv", "[3.479895390629702E-15, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]", new int[] {0, 0, 0, 0, 0, 0, 0, 0}, false))},
                 { weight(new ARXAnonymizationTestCase(ARXConfiguration.create(1.0d, Metric_V2.createNDSMetric(0.0d)).addCriterion(new HierarchicalDistanceTCloseness("occupation", 0.2, Hierarchy.create("../arx-data/data-junit/adult_hierarchy_occupation.csv", ';'))), "occupation", "../arx-data/data-junit/adult.csv", "[3.479895390629702E-15, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]", new int[] {0, 0, 0, 0, 0, 0, 0, 0}, false))},
                 { weight(new ARXAnonymizationTestCase(ARXConfiguration.create(1.0d, Metric_V2.createNDSMetric(0.0d)).addCriterion(new RecursiveCLDiversity("occupation", 4.0, 5)), "occupation", "../arx-data/data-junit/adult.csv", "[3.479895390629702E-15, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]", new int[] {0, 0, 0, 0, 0, 0, 0, 0}, false))},
                 { weight(new ARXAnonymizationTestCase(ARXConfiguration.create(0.05d, Metric_V2.createNDSMetric(0.0d)).addCriterion(new KAnonymity(5)).addCriterion(new HierarchicalDistanceTCloseness("occupation", 0.2, Hierarchy.create("../arx-data/data-junit/adult_hierarchy_occupation.csv", ';'))), "occupation", "../arx-data/data-junit/adult.csv", "[0.24324324324324326, 0.1891891891891892, 0.08108108108108109, 0.05405405405405406, 0.049563886544192894, 0.04682820875381051, 0.04406824767875098, 0.02702702702702703]", new int[] {1, 4, 1, 1, 2, 1, 2, 1}, false))},
                 { weight(new ARXAnonymizationTestCase(ARXConfiguration.create(0.05d, Metric_V2.createNDSMetric(0.0d)).addCriterion(new RecursiveCLDiversity("occupation", 4.0, 5)), "occupation", "../arx-data/data-junit/adult.csv", "[0.05405405405405406, 0.054041509183741135, 0.049563886544192894, 0.046828208753810566, 0.044068247678751137, 0.02702702702702703, 0.0, 0.0]", new int[] {1, 4, 0, 1, 2, 1, 1, 0}, false))},
                 { weight(new ARXAnonymizationTestCase(ARXConfiguration.create(0.05d, Metric_V2.createNDSMetric(0.0d)).addCriterion(new KAnonymity(5)).addCriterion(new HierarchicalDistanceTCloseness("occupation", 0.2, Hierarchy.create("../arx-data/data-junit/adult_hierarchy_occupation.csv", ';'))), "occupation", "../arx-data/data-junit/adult.csv", "[0.24324324324324326, 0.1891891891891892, 0.08108108108108109, 0.05405405405405406, 0.049563886544192894, 0.04682820875381051, 0.04406824767875098, 0.02702702702702703]", new int[] {1, 4, 1, 1, 2, 1, 2, 1}, false))},
                 { weight(new ARXAnonymizationTestCase(ARXConfiguration.create(0.05d, Metric_V2.createNDSMetric(0.0d)).addCriterion(new RecursiveCLDiversity("occupation", 4.0, 5)), "occupation", "../arx-data/data-junit/adult.csv", "[0.05405405405405406, 0.054041509183741135, 0.049563886544192894, 0.046828208753810566, 0.044068247678751137, 0.02702702702702703, 0.0, 0.0]", new int[] {1, 4, 0, 1, 2, 1, 1, 0}, false))},
                 { weight(new ARXAnonymizationTestCase(ARXConfiguration.create(0.05d, Metric_V2.createNDSMetric(0.0d)).addCriterion(new HierarchicalDistanceTCloseness("occupation", 0.2, Hierarchy.create("../arx-data/data-junit/adult_hierarchy_occupation.csv", ';'))), "occupation", "../arx-data/data-junit/adult.csv", "[0.24324324324324326, 0.1891891891891892, 0.08108108108108109, 0.05405405405405406, 0.049563886544192894, 0.04682820875381051, 0.04406824767875098, 0.02702702702702703]", new int[] {1, 4, 1, 1, 2, 1, 2, 1}, false))},
                 { weight(new ARXAnonymizationTestCase(ARXConfiguration.create(0.05d, Metric_V2.createNDSMetric(0.0d)).addCriterion(new HierarchicalDistanceTCloseness("occupation", 0.2, Hierarchy.create("../arx-data/data-junit/adult_hierarchy_occupation.csv", ';'))), "occupation", "../arx-data/data-junit/adult.csv", "[0.24324324324324326, 0.1891891891891892, 0.08108108108108109, 0.05405405405405406, 0.049563886544192894, 0.04682820875381051, 0.04406824767875098, 0.02702702702702703]", new int[] {1, 4, 1, 1, 2, 1, 2, 1}, false))},

                 // Weighted NDS with Suppression/Generalization: 0.33d
                 { weight(new ARXAnonymizationTestCase(ARXConfiguration.create(1.0d, Metric_V2.createNDSMetric(0.33d)).addCriterion(new KAnonymity(5)).addCriterion(new HierarchicalDistanceTCloseness("occupation", 0.2, Hierarchy.create("../arx-data/data-junit/adult_hierarchy_occupation.csv", ';'))), "occupation", "../arx-data/data-junit/adult.csv", "[0.08143592169851356, 0.08108108108108109, 0.07836077971745363, 0.07144350238442089, 0.06333905020994678, 0.05429061446567029, 0.05405405405405406, 0.02702702702702703]", new int[] {1, 4, 1, 1, 2, 0, 0, 0}, false))},
                 { weight(new ARXAnonymizationTestCase(ARXConfiguration.create(1.0d, Metric_V2.createNDSMetric(0.33d)).addCriterion(new KAnonymity(5)), "occupation", "../arx-data/data-junit/adult.csv", "[0.02702702702702703, 0.02384528949080456, 0.018546336270628818, 0.01589685966053481, 0.014655992774154745, 0.013247383050446126, 0.01059790644035551, 0.007948429830267986]", new int[] {1, 3, 0, 0, 0, 0, 0, 0}, false))},
                 { weight(new ARXAnonymizationTestCase(ARXConfiguration.create(1.0d, Metric_V2.createNDSMetric(0.33d)).addCriterion(new HierarchicalDistanceTCloseness("occupation", 0.2, Hierarchy.create("../arx-data/data-junit/adult_hierarchy_occupation.csv", ';'))), "occupation", "../arx-data/data-junit/adult.csv", "[0.08143592169851356, 0.08108108108108109, 0.07836077971745363, 0.07144350238442089, 0.06333905020994678, 0.05429061446567029, 0.05405405405405406, 0.02702702702702703]", new int[] {1, 4, 1, 1, 2, 0, 0, 0}, false))},
                 { weight(new ARXAnonymizationTestCase(ARXConfiguration.create(1.0d, Metric_V2.createNDSMetric(0.33d)).addCriterion(new RecursiveCLDiversity("occupation", 4.0, 5)), "occupation", "../arx-data/data-junit/adult.csv", "[0.042784883550746604, 0.03609793601042787, 0.028076172452542836, 0.02702702702702703, 0.024065290673606774, 0.016856243552084524, 0.016043527115735947, 0.012032645336800145]", new int[] {1, 3, 0, 0, 1, 0, 0, 0}, false))},
                 { weight(new ARXAnonymizationTestCase(ARXConfiguration.create(0.05d, Metric_V2.createNDSMetric(0.33d)).addCriterion(new KAnonymity(5)).addCriterion(new HierarchicalDistanceTCloseness("occupation", 0.2, Hierarchy.create("../arx-data/data-junit/adult_hierarchy_occupation.csv", ';'))), "occupation", "../arx-data/data-junit/adult.csv", "[0.24324324324324326, 0.1891891891891892, 0.08108108108108109, 0.05405405405405406, 0.05254178785907448, 0.049029797651241866, 0.04803829321663021, 0.02702702702702703]", new int[] {1, 4, 1, 1, 2, 1, 2, 1}, false))},
                 { weight(new ARXAnonymizationTestCase(ARXConfiguration.create(0.05d, Metric_V2.createNDSMetric(0.33d)).addCriterion(new RecursiveCLDiversity("occupation", 4.0, 5)), "occupation", "../arx-data/data-junit/adult.csv", "[0.05817481097568645, 0.05405405405405406, 0.05211420491508024, 0.0491311243608836, 0.04781305813472114, 0.02702702702702703, 0.007425039919569144, 0.0024750133065231947]", new int[] {1, 4, 0, 1, 2, 1, 1, 0}, false))},
                 { weight(new ARXAnonymizationTestCase(ARXConfiguration.create(0.05d, Metric_V2.createNDSMetric(0.33d)).addCriterion(new KAnonymity(5)).addCriterion(new HierarchicalDistanceTCloseness("occupation", 0.2, Hierarchy.create("../arx-data/data-junit/adult_hierarchy_occupation.csv", ';'))), "occupation", "../arx-data/data-junit/adult.csv", "[0.24324324324324326, 0.1891891891891892, 0.08108108108108109, 0.05405405405405406, 0.05254178785907448, 0.049029797651241866, 0.04803829321663021, 0.02702702702702703]", new int[] {1, 4, 1, 1, 2, 1, 2, 1}, false))},
                 { weight(new ARXAnonymizationTestCase(ARXConfiguration.create(0.05d, Metric_V2.createNDSMetric(0.33d)).addCriterion(new RecursiveCLDiversity("occupation", 4.0, 5)), "occupation", "../arx-data/data-junit/adult.csv", "[0.05817481097568645, 0.05405405405405406, 0.05211420491508024, 0.0491311243608836, 0.04781305813472114, 0.02702702702702703, 0.007425039919569144, 0.0024750133065231947]", new int[] {1, 4, 0, 1, 2, 1, 1, 0}, false))},
                 { weight(new ARXAnonymizationTestCase(ARXConfiguration.create(0.05d, Metric_V2.createNDSMetric(0.33d)).addCriterion(new HierarchicalDistanceTCloseness("occupation", 0.2, Hierarchy.create("../arx-data/data-junit/adult_hierarchy_occupation.csv", ';'))), "occupation", "../arx-data/data-junit/adult.csv", "[0.24324324324324326, 0.1891891891891892, 0.08108108108108109, 0.05405405405405406, 0.05254178785907448, 0.049029797651241866, 0.04803829321663021, 0.02702702702702703]", new int[] {1, 4, 1, 1, 2, 1, 2, 1}, false))},
                 { weight(new ARXAnonymizationTestCase(ARXConfiguration.create(0.05d, Metric_V2.createNDSMetric(0.33d)).addCriterion(new HierarchicalDistanceTCloseness("occupation", 0.2, Hierarchy.create("../arx-data/data-junit/adult_hierarchy_occupation.csv", ';'))), "occupation", "../arx-data/data-junit/adult.csv", "[0.24324324324324326, 0.1891891891891892, 0.08108108108108109, 0.05405405405405406, 0.05254178785907448, 0.049029797651241866, 0.04803829321663021, 0.02702702702702703]", new int[] {1, 4, 1, 1, 2, 1, 2, 1}, false))},
                 
                 // Weighted NDS with Suppression/Generalization: 0.66d
                 { weight(new ARXAnonymizationTestCase(ARXConfiguration.create(1.0d, Metric_V2.createNDSMetric(0.66d)).addCriterion(new KAnonymity(5)).addCriterion(new HierarchicalDistanceTCloseness("occupation", 0.2, Hierarchy.create("../arx-data/data-junit/adult_hierarchy_occupation.csv", ';'))), "occupation", "../arx-data/data-junit/adult.csv", "[0.08455054075099273, 0.08207956655454093, 0.07800848391658019, 0.07233897592212692, 0.06548325210447921, 0.06068172807778934, 0.04222357949717121, 0.01812549117104518]", new int[] {1, 4, 1, 2, 2, 1, 1, 0}, false))},
                 { weight(new ARXAnonymizationTestCase(ARXConfiguration.create(1.0d, Metric_V2.createNDSMetric(0.66d)).addCriterion(new KAnonymity(5)), "occupation", "../arx-data/data-junit/adult.csv", "[0.029619498642128955, 0.025435620621616285, 0.019783260483479306, 0.016957080414410818, 0.015293283047410757, 0.011948673925829755, 0.011304720276273897, 0.008478540207205428]", new int[] {1, 3, 0, 0, 1, 0, 0, 0}, false))},
                 { weight(new ARXAnonymizationTestCase(ARXConfiguration.create(1.0d, Metric_V2.createNDSMetric(0.66d)).addCriterion(new HierarchicalDistanceTCloseness("occupation", 0.2, Hierarchy.create("../arx-data/data-junit/adult_hierarchy_occupation.csv", ';'))), "occupation", "../arx-data/data-junit/adult.csv", "[0.08455054075099273, 0.08207956655454093, 0.07800848391658019, 0.07233897592212692, 0.06548325210447921, 0.06068172807778934, 0.04222357949717121, 0.01812549117104518]", new int[] {1, 4, 1, 2, 2, 1, 1, 0}, false))},
                 { weight(new ARXAnonymizationTestCase(ARXConfiguration.create(1.0d, Metric_V2.createNDSMetric(0.66d)).addCriterion(new RecursiveCLDiversity("occupation", 4.0, 5)), "occupation", "../arx-data/data-junit/adult.csv", "[0.042274259245238886, 0.03766095469850803, 0.03744381140786103, 0.03599673730964758, 0.034255594541443335, 0.014529077787482395, 0.011250060484196118, 0.0037500201613987223]", new int[] {1, 4, 0, 1, 2, 1, 1, 0}, false))},
                 { weight(new ARXAnonymizationTestCase(ARXConfiguration.create(0.05d, Metric_V2.createNDSMetric(0.66d)).addCriterion(new KAnonymity(5)).addCriterion(new HierarchicalDistanceTCloseness("occupation", 0.2, Hierarchy.create("../arx-data/data-junit/adult_hierarchy_occupation.csv", ';'))), "occupation", "../arx-data/data-junit/adult.csv", "[0.12530712530712532, 0.12302466400827056, 0.1093951093951094, 0.08997247900642157, 0.05105105105105105, 0.03663832983204711, 0.030230868942333358, 0.0]", new int[] {0, 4, 1, 1, 3, 2, 2, 1}, false))},
                 { weight(new ARXAnonymizationTestCase(ARXConfiguration.create(0.05d, Metric_V2.createNDSMetric(0.66d)).addCriterion(new RecursiveCLDiversity("occupation", 4.0, 5)), "occupation", "../arx-data/data-junit/adult.csv", "[0.042274259245238886, 0.03766095469850803, 0.03744381140786103, 0.03599673730964758, 0.034255594541443335, 0.014529077787482395, 0.011250060484196118, 0.0037500201613987223]", new int[] {1, 4, 0, 1, 2, 1, 1, 0}, false))},
                 { weight(new ARXAnonymizationTestCase(ARXConfiguration.create(0.05d, Metric_V2.createNDSMetric(0.66d)).addCriterion(new KAnonymity(5)).addCriterion(new HierarchicalDistanceTCloseness("occupation", 0.2, Hierarchy.create("../arx-data/data-junit/adult_hierarchy_occupation.csv", ';'))), "occupation", "../arx-data/data-junit/adult.csv", "[0.12530712530712532, 0.12302466400827056, 0.1093951093951094, 0.08997247900642157, 0.05105105105105105, 0.03663832983204711, 0.030230868942333358, 0.0]", new int[] {0, 4, 1, 1, 3, 2, 2, 1}, false))},
                 { weight(new ARXAnonymizationTestCase(ARXConfiguration.create(0.05d, Metric_V2.createNDSMetric(0.66d)).addCriterion(new RecursiveCLDiversity("occupation", 4.0, 5)), "occupation", "../arx-data/data-junit/adult.csv", "[0.042274259245238886, 0.03766095469850803, 0.03744381140786103, 0.03599673730964758, 0.034255594541443335, 0.014529077787482395, 0.011250060484196118, 0.0037500201613987223]", new int[] {1, 4, 0, 1, 2, 1, 1, 0}, false))},
                 { weight(new ARXAnonymizationTestCase(ARXConfiguration.create(0.05d, Metric_V2.createNDSMetric(0.66d)).addCriterion(new HierarchicalDistanceTCloseness("occupation", 0.2, Hierarchy.create("../arx-data/data-junit/adult_hierarchy_occupation.csv", ';'))), "occupation", "../arx-data/data-junit/adult.csv", "[0.12530712530712532, 0.12302466400827056, 0.1093951093951094, 0.08997247900642157, 0.05105105105105105, 0.03663832983204711, 0.030230868942333358, 0.0]", new int[] {0, 4, 1, 1, 3, 2, 2, 1}, false))},
                 { weight(new ARXAnonymizationTestCase(ARXConfiguration.create(0.05d, Metric_V2.createNDSMetric(0.66d)).addCriterion(new HierarchicalDistanceTCloseness("occupation", 0.2, Hierarchy.create("../arx-data/data-junit/adult_hierarchy_occupation.csv", ';'))), "occupation", "../arx-data/data-junit/adult.csv", "[0.12530712530712532, 0.12302466400827056, 0.1093951093951094, 0.08997247900642157, 0.05105105105105105, 0.03663832983204711, 0.030230868942333358, 0.0]", new int[] {0, 4, 1, 1, 3, 2, 2, 1}, false))},

                 // Weighted NDS with Suppression/Generalization: 1.0d
                 { weight(new ARXAnonymizationTestCase(ARXConfiguration.create(1.0d, Metric_V2.createNDSMetric(1.0d)).addCriterion(new KAnonymity(5)).addCriterion(new HierarchicalDistanceTCloseness("occupation", 0.2, Hierarchy.create("../arx-data/data-junit/adult_hierarchy_occupation.csv", ';'))), "occupation", "../arx-data/data-junit/adult.csv", "[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]", new int[] {1, 4, 0, 2, 3, 2, 2, 1}, false))},
                 { weight(new ARXAnonymizationTestCase(ARXConfiguration.create(1.0d, Metric_V2.createNDSMetric(1.0d)).addCriterion(new KAnonymity(5)), "occupation", "../arx-data/data-junit/adult.csv", "[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]", new int[] {1, 4, 0, 2, 3, 2, 2, 0}, false))},
                 { weight(new ARXAnonymizationTestCase(ARXConfiguration.create(1.0d, Metric_V2.createNDSMetric(1.0d)).addCriterion(new HierarchicalDistanceTCloseness("occupation", 0.2, Hierarchy.create("../arx-data/data-junit/adult_hierarchy_occupation.csv", ';'))), "occupation", "../arx-data/data-junit/adult.csv", "[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]", new int[] {1, 4, 0, 2, 3, 2, 2, 1}, false))},
                 { weight(new ARXAnonymizationTestCase(ARXConfiguration.create(1.0d, Metric_V2.createNDSMetric(1.0d)).addCriterion(new RecursiveCLDiversity("occupation", 4.0, 5)), "occupation", "../arx-data/data-junit/adult.csv", "[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]", new int[] {1, 4, 0, 2, 3, 2, 2, 0}, false))},
                 { weight(new ARXAnonymizationTestCase(ARXConfiguration.create(0.05d, Metric_V2.createNDSMetric(1.0d)).addCriterion(new KAnonymity(5)).addCriterion(new HierarchicalDistanceTCloseness("occupation", 0.2, Hierarchy.create("../arx-data/data-junit/adult_hierarchy_occupation.csv", ';'))), "occupation", "../arx-data/data-junit/adult.csv", "[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]", new int[] {1, 4, 0, 2, 3, 2, 2, 1}, false))},
                 { weight(new ARXAnonymizationTestCase(ARXConfiguration.create(0.05d, Metric_V2.createNDSMetric(1.0d)).addCriterion(new RecursiveCLDiversity("occupation", 4.0, 5)), "occupation", "../arx-data/data-junit/adult.csv", "[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]", new int[] {1, 4, 0, 2, 3, 2, 2, 0}, false))},
                 { weight(new ARXAnonymizationTestCase(ARXConfiguration.create(0.05d, Metric_V2.createNDSMetric(1.0d)).addCriterion(new KAnonymity(5)).addCriterion(new HierarchicalDistanceTCloseness("occupation", 0.2, Hierarchy.create("../arx-data/data-junit/adult_hierarchy_occupation.csv", ';'))), "occupation", "../arx-data/data-junit/adult.csv", "[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]", new int[] {1, 4, 0, 2, 3, 2, 2, 1}, false))},
                 { weight(new ARXAnonymizationTestCase(ARXConfiguration.create(0.05d, Metric_V2.createNDSMetric(1.0d)).addCriterion(new RecursiveCLDiversity("occupation", 4.0, 5)), "occupation", "../arx-data/data-junit/adult.csv", "[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]", new int[] {1, 4, 0, 2, 3, 2, 2, 0}, false))},
                 { weight(new ARXAnonymizationTestCase(ARXConfiguration.create(0.05d, Metric_V2.createNDSMetric(1.0d)).addCriterion(new HierarchicalDistanceTCloseness("occupation", 0.2, Hierarchy.create("../arx-data/data-junit/adult_hierarchy_occupation.csv", ';'))), "occupation", "../arx-data/data-junit/adult.csv", "[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]", new int[] {1, 4, 0, 2, 3, 2, 2, 1}, false))},
                 { weight(new ARXAnonymizationTestCase(ARXConfiguration.create(0.05d, Metric_V2.createNDSMetric(1.0d)).addCriterion(new HierarchicalDistanceTCloseness("occupation", 0.2, Hierarchy.create("../arx-data/data-junit/adult_hierarchy_occupation.csv", ';'))), "occupation", "../arx-data/data-junit/adult.csv", "[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]", new int[] {1, 4, 0, 2, 3, 2, 2, 1}, false))},

        });
    }
    
    /**
     * Apply weights to the test case
     * @return the test case passed to the method
     * @throws IOException 
     */
    private static ARXAnonymizationTestCase weight(ARXAnonymizationTestCase testcase) throws IOException {
        
        // Create temporary data object
        Data data = Data.create(testcase.dataset, ';');
        DataHandle handle = data.getHandle();
        
        // Weight attributes according to their order in the dataset
        for (int i=0; i<handle.getNumColumns(); i++) {
            testcase.config.setAttributeWeight(handle.getAttributeName(i), i+1);
        }
        
        // Return argument
        return testcase;
    }

    /**
     * Creates a new instance
     * @param testCase
     */
    public TestMetricNDS(final ARXAnonymizationTestCase testCase) {
        super(testCase);
    }
}
